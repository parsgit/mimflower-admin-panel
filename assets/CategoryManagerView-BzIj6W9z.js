import{_ as g}from"./MyInput-BNXAEYVD.js";import{_ as C}from"./MyCheckbox-aFIDKpvi.js";import{p as u,r as v,q as h,x as _,c as a,a as o,F as B,h as $,e as i,P as y,s as N,o as r,t as b}from"./index-BD8aCjIk.js";import{_ as U}from"./List-DHlu07CZ.js";const P={class:"mt-12 bg-base-200 rounded-xl shadow p-4"},j={class:"breadcrumbs text-sm p-4"},A=["onClick"],D={key:1},E={class:"bg-base-200 mt-4 p-4 rounded-b-xl w-full"},F={class:"mt-2 flex flex-wrap items-end gap-4"},L={class:"h-full flex items-center"},G={__name:"CategoryManagerView",setup(M){const c={id:0,title:"",type:"",link:""};u({...c});const l=u({...c});u([]);const d=v("0"),p=u([]),m=v([]),k=()=>{l.parent=d.value,y("category/save",{category:l}).then(t=>{t.ok&&(N("Success","success"),Object.assign(l,c),n())})},V=t=>{y("category/remove",{id:t.id}).then(e=>{n()})},w=(t,e)=>{e.id=="edit"?Object.assign(l,t):e.id=="open"&&(console.log(t),f(t))},n=()=>{y("category/list-by-parent",{parent:d.value}).then(t=>{t.ok&&(p.splice(0),t.list.forEach(e=>p.push(e)),m.value=t.tree)})},f=(t,e)=>{console.log(t),d.value=t.id,n()};return h(()=>{n()}),_(d,t=>{n()}),_(()=>l.title,t=>{t.length>0&&(l.link=l.title.replace(/ /g,"-").toLowerCase())}),(t,e)=>(r(),a("div",null,[e[6]||(e[6]=o("div",{class:"alert alert-info shadow-lg"}," اعمال تغییر در دسته‌بندی ها بدون دانش کافی از نحوه کار آن ممکن است باعث بروز مشکلاتی در نمایش محصولات شود ",-1)),o("div",P,[o("div",null,[o("div",j,[o("ul",null,[o("li",null,[o("a",{onClick:e[0]||(e[0]=s=>f({id:0}))},"اصلی")]),(r(!0),a(B,null,$(m.value,(s,x)=>(r(),a("li",{key:s.id},[x+1<m.value.length?(r(),a("a",{key:0,onClick:O=>f(s)},b(s.title),9,A)):(r(),a("span",D,b(s.title),1))]))),128))])])]),o("div",null,[i(U,{class:"mt-4",list:p,fields:["title","link","type"],btns:[{title:"ورود",id:"open",class:"btn-info"},{title:"ویرایش",id:"edit"},{title:"حذف",id:"delete",class:"btn-error"}],"delete-action":!0,onDelete:V,onBtnAction:w},null,8,["list"])]),o("div",E,[e[5]||(e[5]=o("h3",{class:"font-bold text-xl"},"ایجاد دسته‌بندی",-1)),o("div",F,[i(g,{modelValue:l.title,"onUpdate:modelValue":e[1]||(e[1]=s=>l.title=s),title:"عنوان"},null,8,["modelValue"]),i(g,{modelValue:l.link,"onUpdate:modelValue":e[2]||(e[2]=s=>l.link=s),title:"لینک"},null,8,["modelValue"]),i(g,{modelValue:l.type,"onUpdate:modelValue":e[3]||(e[3]=s=>l.type=s),title:"نوع"},null,8,["modelValue"]),o("div",L,[i(C,{modelValue:l.main,"onUpdate:modelValue":e[4]||(e[4]=s=>l.main=s),title:"دسته‌بندی اصلی"},null,8,["modelValue"])]),o("button",{onClick:k,class:"btn btn-primary"},"ذخیره")])])])]))}};export{G as default};
