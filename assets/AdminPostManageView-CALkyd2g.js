import{_ as w}from"./MyInput-DJTvZvJL.js";import{_ as O,a as F,b as z}from"./FileUploader-CwBbLgxH.js";import{c as i,o as a,a as t,t as g,p as L,_ as R,q as E,r as k,s as q,F as P,f as B,n as I,x as M,e as U,y as K,P as A,z as Z,m as G,g as H,h as r,i as S,u as J,l as Q,k as W,j as X,A as Y,B as j}from"./index-e0NitUN3.js";const ee={class:"container mx-auto p-6 bg-base-200 rounded-xl"},te={class:"text-3xl text-base-content font-bold"},le={class:"mt-10"},T={__name:"ContentCard",props:{title:String},setup(y){const m=y;return(f,l)=>(a(),i("div",ee,[t("h2",te,g(m.title),1),t("div",le,[L(f.$slots,"default",{class:"mt-10"})])]))}},se={},ae={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"};function oe(y,m){return a(),i("svg",ae,m[0]||(m[0]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"},null,-1)]))}const ne=R(se,[["render",oe]]),ie={class:"breadcrumbs text-sm p-4 font-bold"},de=["onClick"],ue={key:1},re={class:"flex flex-col gap-4"},ce={class:"flex gap-4 sm:gap-8 items-center"},pe={class:"text-xl font-bold"},me={class:"text-lg font-bold"},ve={class:"flex gap-2 items-center"},_e=["onClick"],fe={__name:"CategorySelector",props:E({selectMode:{default:!1},btnOpen:{default:!1},btnSelect:{default:!1},btnDelete:{default:!1},btnDefault:{default:!0}},{modelValue:{},modelModifiers:{}}),emits:E(["select","open","edit","delete"],["update:modelValue"]),setup(y,{expose:m,emit:f}){const l=k([]),b=k([]),v=k(0),c=k([]),V=f,_=q(y,"modelValue"),x=y;x.btnDefault==!1?(c.value=[],x.btnSelect&&c.value.push({title:"Select",id:"select",class:"btn-info"}),x.btnOpen&&c.value.push({title:"Open",id:"open",class:"btn-info"}),x.btnDelete&&c.value.push({title:"Delete",id:"delete",class:"btn-error"})):c.value=[{title:"Open",id:"open",class:"btn-info"},{title:"Edit",id:"edit"},{title:"Delete",id:"delete",class:"btn-error"}];const u=(o,d)=>{d.id=="edit"?V("edit",o):d.id=="open"?(V("open",o),e(o)):d.id=="select"?(V("select",o),_.value=o.id):d.id=="delete"&&V("delete",o)},e=(o,d)=>{v.value=o.id,h()},h=(o="parent")=>{let d={};o=="parent"?d={parent:v.value}:d={id:_.value},console.log("getCategorylistByParent",d),A("category/list-by-parent",d).then(n=>{n.ok&&(l.value=n.list,b.value=n.tree)})},s=o=>_.value==o.id?"bg-teal-100":"";return m({loadById:o=>{_.value=o,K(()=>{h("id")})},loadMain:()=>{v.value=0,h()}}),(o,d)=>(a(),i("div",null,[t("div",null,[t("div",ie,[t("ul",null,[t("li",null,[t("a",{onClick:d[0]||(d[0]=n=>e({id:0}))},"Main")]),(a(!0),i(P,null,B(b.value,(n,D)=>(a(),i("li",{key:n.id},[D+1<b.value.length?(a(),i("a",{key:0,onClick:C=>e(n)},g(n.title),9,de)):(a(),i("span",ue,g(n.title),1))]))),128))])])]),t("div",re,[(a(!0),i(P,null,B(l.value,(n,D)=>(a(),i("div",{key:D,class:I([[s(n)],"flex gap-4 justify-between bg-base-100 rounded-xl p-4 shadow"])},[t("div",ce,[t("div",pe,g(n.title),1),t("div",me,g(n.link),1)]),t("div",ve,[n.id==_.value?(a(),M(ne,{key:0,class:"text-green-500 size-10"})):U("",!0),(a(!0),i(P,null,B(c.value,(C,N)=>(a(),i("button",{onClick:Be=>u(n,C),class:I(["btn btn-outline",C==null?void 0:C.class]),key:N},g(C.title),11,_e))),128))])],2))),128))])]))}},be={class:"flex gap-4"},xe={class:"flex-1"},ge={class:"mb-4"},ke={class:"mb-4"},ye={class:"border bg-black/10 p-2 rounded-xl"},Ve={class:"mb-4"},Ce={class:"flex gap-4 mt-6 flex justify-center"},he={class:"mb-4"},$e={class:"mb-4"},we={class:"mb-4"},Se={class:"flex items-center justify-between mt-16"},Pe={class:"flex items-center gap-4 md:gap-8"},Te={__name:"AdminPostManageView",setup(y){const m=J(),f=H(),l=k({}),b=k(null),v=k([]);Z(()=>l.value.title,(u,e)=>{l.value.link=l.value.title.replaceAll(" ","-")});const c=u=>{const e=new Date().getTime();v.value.push({id:e,type:u})},V=()=>{l.value.contents=v.value,A("post/save",{post:l.value}).then(u=>{u.ok?j({text:"Success",icon:"success"}).then(async()=>{await m.replace({name:"admin_post_edit",params:{id:u.post_id}}),_()}):j({text:u.message,icon:"error"})})},_=()=>{const u=f.params.id;A("post/info",{id:u}).then(e=>{e.ok&&(l.value=e.post,v.value=e.post.contents,b.value.loadById(l.value.category_id))})},x=()=>({api_token:Y.getApiToken()});return G(()=>{f.name=="admin_post_edit"?_():b.value.loadMain()}),(u,e)=>{const h=Q("router-link");return a(),i("div",null,[r(T,{title:"Create New Post"},{default:S(()=>[t("div",be,[t("div",xe,[t("div",ge,[r(w,{modelValue:l.value.title,"onUpdate:modelValue":e[0]||(e[0]=s=>l.value.title=s),title:"Title","title-class":"font-bold text-base-content text-xl","input-class":"input-primary"},null,8,["modelValue"])]),t("div",ke,[r(w,{modelValue:l.value.link,"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.link=s),title:"Link","title-class":"font-bold text-base-content text-xl","input-class":"input-primary"},null,8,["modelValue"])]),t("div",ye,[e[9]||(e[9]=t("div",null,[t("h3",{class:"text-xl font-bold"},"Select Category")],-1)),r(fe,{ref_key:"categoryComponent",ref:b,"btn-default":!1,"select-mode":!1,"btn-open":!0,"btn-select":!0,modelValue:l.value.category_id,"onUpdate:modelValue":e[2]||(e[2]=s=>l.value.category_id=s)},null,8,["modelValue"])])]),t("div",null,[r(O,{"upload-url":"admin/post/upload-image","upload-params":x(),title:"Featured photo",class:"w-72",modelValue:l.value.image,"onUpdate:modelValue":e[3]||(e[3]=s=>l.value.image=s)},null,8,["upload-params","modelValue"])])])]),_:1}),r(T,{title:"Content",class:"mt-8"},{default:S(()=>[t("div",Ve,[(a(!0),i(P,null,B(v.value,(s,p)=>(a(),i("div",{key:p,class:"mb-4"},[s.type=="richbox"?(a(),M(F,{key:0,title:"Text Content","com-id":s.id,modelValue:s.content,"onUpdate:modelValue":$=>s.content=$},null,8,["com-id","modelValue","onUpdate:modelValue"])):U("",!0),s.type=="image"?(a(),M(O,{key:1,id:"file_uploader"+p,"upload-url":"admin/post/upload-image","upload-params":x(),title:"Upload photo",class:"w-72",modelValue:s.image,"onUpdate:modelValue":$=>s.image=$,"max-w":"400"},null,8,["id","upload-params","modelValue","onUpdate:modelValue"])):U("",!0)]))),128)),t("div",Ce,[t("button",{onClick:e[4]||(e[4]=s=>c("richbox")),class:"btn btn-secondary"},"Add Richbox"),t("button",{onClick:e[5]||(e[5]=s=>c("image")),class:"btn btn-secondary"},"Add Image")])])]),_:1}),r(T,{title:"SEO Fields",class:"mt-8"},{default:S(()=>{var s;return[t("div",he,[r(w,{modelValue:l.value.meta_title,"onUpdate:modelValue":e[6]||(e[6]=p=>l.value.meta_title=p),"title-class":"font-bold text-xl text-base-content ","input-class":"input-primary",title:"SEO Title"},null,8,["modelValue"])]),t("div",$e,[r(z,{modelValue:l.value.meta_description,"onUpdate:modelValue":e[7]||(e[7]=p=>l.value.meta_description=p),"title-class":"font-bold text-base-content text-xl","textarea-class":"textarea-primary",title:"SEO Description"},null,8,["modelValue"])]),t("div",we,[r(w,{modelValue:l.value.meta_keywords,"onUpdate:modelValue":e[8]||(e[8]=p=>l.value.meta_keywords=p),"title-class":"font-bold text-base-content text-xl","input-class":"input-primary",title:"SEO Keywords"},null,8,["modelValue"])]),t("div",Se,[t("div",Pe,[t("button",{onClick:V,class:"btn btn-primary px-12 btn-lg",type:"submit"},g(W(f).name=="admin_post_edit"?"Save post":"Create Post"),1),(s=l.value)!=null&&s.title?(a(),M(h,{key:0,class:"btn btn-secondary btn-lg",target:"_blank",to:{name:"post_view",params:{id:l.value.id,title:l.value.link}}},{default:S(()=>e[10]||(e[10]=[X("Preview")])),_:1},8,["to"])):U("",!0)])])]}),_:1})])}}};export{Te as default};
