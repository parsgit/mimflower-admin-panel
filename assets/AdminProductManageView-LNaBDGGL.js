import{r as _,x as A,q as ee,m as te,c,e as i,f as y,P as h,G as le,u as se,g as oe,o as u,a as t,F as D,h as P,j as x,w as m,k as V,y as U,l as L,v as N,z as ae,B as R,I as E,t as F,b as ne,A as ie,s as f}from"./index-B4PKXO22.js";import{_ as C}from"./MyInput-4xnieHBO.js";import{_ as B}from"./Richbox-D9RGU4NV.js";import{_ as I,I as de,a as ue}from"./IconChevronUp-B49AfuIk.js";import{_ as G}from"./FileUploader-CJEcG-um.js";import{_ as re}from"./CategorySelector-BXOP47ws.js";const ce={class:"flex flex-wrap gap-4"},me={class:"flex-1 w-full"},pe={class:"grid grid-cols-1 lg:grid-cols-2 gap-2 lg:gap-8"},ve={class:"mb-4"},_e={class:"mb-4"},fe={class:"border bg-black/10 p-2 rounded-xl mt-10"},ge={dir:"rtl",class:"flex gap-4 items-center"},be={class:"flex gap-4 items-center"},ye={class:"mb-4"},he={class:"flex items-center justify-between"},xe={key:0,class:"p-4"},Ve={key:1,class:"w-full"},ke={class:"flex flex-wrap items-center gap-2 bg-gray-100 rounded-t-xl p-2 w-full"},we=["onUpdate:modelValue"],Ue=["onUpdate:modelValue"],Ce=["onUpdate:modelValue"],Ie=["onUpdate:modelValue"],$e=["onUpdate:modelValue"],je={class:"flex flex-col 2xl:flex-row items-start gap-4 justify-between w-full mt-4 p-2 lg:p-4"},ze=["onUpdate:modelValue"],De={class:"flex items-center gap-2 mt-4 bg-gray-100 rounded-b-xl p-2"},Pe=["onClick","disabled"],Be=["onClick","disabled"],Me=["onClick"],Se={class:"flex gap-4 mt-6 flex justify-center"},Te={dir:"rtl"},qe=["value"],Ae={class:"flex-1 w-full"},Le={class:"flex-1 w-full"},Ne={class:"flex justify-end items-end gap-2"},Re=["onClick"],Ee={key:1,class:"text-xl font-bold text-center"},Fe={key:2,class:"mt-4 text-center"},Ge={for:""},Oe=["checked"],Je={class:"flex items-center justify-between mt-16"},He={class:"flex text-center w-full justify-center items-center gap-4 md:gap-8"},tt={__name:"AdminProductManageView",setup(Ke){const O=se(),$=te(),a=_({}),k=_(null),d=_([]),r=_([]),b=_(0),g=_(!0);A(()=>a.value.title,(s,l)=>{a.value.link=a.value.title.replaceAll(" ","-").toLowerCase()}),A(b,s=>{console.log("watch(selectInventory",s),r.value.length==0?r.value.push({name:s,quantity:1,type:"size",price:0}):r.value[0].name=s});const M=s=>{const l=new Date().getTime();d.value.push({id:l,type:s})},J=(s,l=!0)=>{console.log(s),h("admin/product-inventory/save",{...s,product_id:a.value.id}).then(p=>{p.ok&&l==!1&&(f("Inventory Saved","","success"),w())})},H=()=>{r.value.push({title:"",quantity:1,type:"no_type",price:0})},K=(s,l)=>{f({title:"حذف موجودی",text:`آیا از حذف  "${s.name||" اطمینان دارید "}"?`,icon:"warning",buttons:["لغو","حذف"],dangerMode:!0}).then(p=>{p&&(s.id?h("admin/product-inventory/delete",{id:s.id}).then(e=>{e.ok?(f("Deleted!","The inventory item has been removed.","success"),w()):f("Error","Failed to delete inventory item.","error")}).catch(e=>{console.error("Error deleting inventory item:",e),f("Error","An unexpected error occurred.","error")}):r.value.splice(l,1))})},Q=()=>{a.value.contents=d.value,h("admin/product/save",{...a.value}).then(s=>{if(s.ok){a.value.id=s.product.id;for(const l of r.value)J(l,!0);f({text:"محصول ذخیره شد",icon:"success"}).then(async()=>{await O.replace({name:"admin_product_edit",params:{id:s.product.id}}),w()})}else f({text:s.message,icon:"error"})})},w=()=>{const s=$.params.id;return h("admin/product/info",{id:s}).then(l=>{l.ok&&(a.value=l.product,d.value=l.product.contents,k.value.loadById(a.value.category_id),r.value=l.inventorys,z(l.category))})},S=()=>({api_token:ie.getApiToken()}),W=s=>{s>0&&([d.value[s],d.value[s-1]]=[d.value[s-1],d.value[s]])},X=s=>{s<d.value.length-1&&([d.value[s],d.value[s+1]]=[d.value[s+1],d.value[s]])},Y=s=>{d.value.splice(s,1)},Z=s=>{z(s)},j=_([]),z=(s,l=!0)=>{h("admin/setting-config/get-config-by-type",{name:"default_product_category",type:"config"}).then(p=>{var v,q;const e=le(p.config),n=JSON.parse(e.json_category.html);((v=e==null?void 0:e.disable_custom_type_creation)==null?void 0:v.value)===!0?g.value=!1:g.value=!0;const o=(q=n[s==null?void 0:s.title])==null?void 0:q.sizes;console.log("custom_sizes:",o),j.value=o,console.log("inventorys.value.length",r.value[0]),r.value.length&&(b.value=r.value[0].name,console.log("selectInventory.value",b.value)),r.value.length==0&&j.value==null&&r.value.push({name:"",quantity:1,type:"size",price:0})})},T=s=>{k.value.loadByLink(s,!1)};return ee(()=>{$.name=="admin_product_edit"?w():(z(),k.value.loadByLink("product",!1))}),(s,l)=>{const p=oe("router-link");return u(),c("div",null,[i(I,{title:"Create New Post"},{default:y(()=>[t("div",ce,[t("div",me,[t("div",pe,[t("div",ve,[i(C,{modelValue:a.value.title,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value.title=e),title:"عنوان محصول","title-class":"font-bold text-base-content text-xl","input-class":"input-primary"},null,8,["modelValue"])]),t("div",_e,[i(C,{modelValue:a.value.link,"onUpdate:modelValue":l[1]||(l[1]=e=>a.value.link=e),title:"لینک محصول(اتوماتیک)","title-class":"font-bold text-base-content text-xl","input-class":"input-primary"},null,8,["modelValue"])])]),t("div",fe,[t("div",ge,[l[10]||(l[10]=t("div",null,[t("h3",{dir:"auto",class:"text-xl font-bold"},"انتخاب دسته بندی")],-1)),t("div",be,[t("button",{onClick:l[2]||(l[2]=e=>T("product")),class:"btn btn-primary btn-sm"},"محصولات"),t("button",{onClick:l[3]||(l[3]=e=>T("some-product")),class:"btn btn-primary btn-sm"},"محصولات جانبی")])]),i(re,{class:"mt-8","show-tree":!1,onSelect:Z,ref_key:"categoryComponent",ref:k,"btn-default":!1,"select-mode":!1,"btn-open":!1,"btn-select":!0,modelValue:a.value.category_id,"onUpdate:modelValue":l[4]||(l[4]=e=>a.value.category_id=e)},null,8,["modelValue"])])]),t("div",null,[i(G,{"upload-url":"admin/upload-image/product","upload-params":S(),title:"عکس شاخص محصول",class:"w-72",modelValue:a.value.image,"onUpdate:modelValue":l[5]||(l[5]=e=>a.value.image=e)},null,8,["upload-params","modelValue"])])])]),_:1}),i(I,{title:"Content",class:"mt-8"},{default:y(()=>[t("div",ye,[(u(!0),c(D,null,P(d.value,(e,n)=>(u(),c("div",{key:e.id,class:"mb-4 bg-white shadow-md rounded-xl"},[t("div",he,[e.type=="richbox"?(u(),c("div",xe,[i(B,{title:"متن","com-id":e.id,modelValue:e.content,"onUpdate:modelValue":o=>e.content=o},null,8,["com-id","modelValue","onUpdate:modelValue"])])):e.type=="image"?(u(),c("div",Ve,[t("div",ke,[t("div",null,[m(t("input",{type:"checkbox","onUpdate:modelValue":o=>e.active_left_content=o,class:"toggle toggle-success"},null,8,we),[[U,e.active_left_content]]),l[11]||(l[11]=V(" Left Description "))]),t("div",null,[m(t("input",{type:"checkbox","onUpdate:modelValue":o=>e.active_right_content=o,class:"toggle toggle-success"},null,8,Ue),[[U,e.active_right_content]]),l[12]||(l[12]=V(" Right Description "))]),t("div",null,[m(t("input",{type:"checkbox","onUpdate:modelValue":o=>e.items_center=o,class:"toggle toggle-success"},null,8,Ce),[[U,e.items_center]]),l[13]||(l[13]=V(" Items Center "))]),t("div",null,[m(t("select",{"onUpdate:modelValue":o=>e.align=o,class:"select select-bordered"},l[14]||(l[14]=[t("option",{disabled:""},"Select align",-1),t("option",{value:"left"},"Left",-1),t("option",{value:"center"},"Center",-1),t("option",{value:"right"},"Right",-1)]),8,Ie),[[L,e.align]])]),t("div",null,[m(t("input",{"onUpdate:modelValue":o=>e.max_width=o,placeholder:"max width",type:"text",class:"input"},null,8,$e),[[N,e.max_width]])])]),t("div",je,[t("div",null,[m(i(B,{"com-id":"el"+e.id,modelValue:e.left_content,"onUpdate:modelValue":o=>e.left_content=o,title:""},null,8,["com-id","modelValue","onUpdate:modelValue"]),[[ae,e.active_left_content]])]),t("div",null,[m(t("input",{class:"input input-primary",placeholder:"Image alt","onUpdate:modelValue":o=>e.alt=o,type:"text"},null,8,ze),[[N,e.alt]]),i(G,{id:"file_uploader"+n,"upload-url":"admin/upload-image/product","upload-params":S(),title:"Upload photo",class:"w-72 mt-2 min-w-[300px]",modelValue:e.image,"onUpdate:modelValue":o=>e.image=o,"max-w":"400"},null,8,["id","upload-params","modelValue","onUpdate:modelValue"])]),t("div",null,[e.active_right_content?(u(),R(B,{key:0,"com-id":"er"+e.id,modelValue:e.right_content,"onUpdate:modelValue":o=>e.right_content=o,title:"Right Description"},null,8,["com-id","modelValue","onUpdate:modelValue"])):x("",!0)])])])):x("",!0)]),t("div",De,[t("button",{onClick:o=>W(n),disabled:n===0,class:"btn btn-secondary btn-sm"},[i(de,{class:"size-8"})],8,Pe),t("button",{onClick:o=>X(n),disabled:n===d.value.length-1,class:"btn btn-secondary btn-sm"},[i(ue,{class:"size-8"})],8,Be),t("button",{onClick:o=>Y(n),class:"btn btn-danger btn-sm"},[i(E,{class:"size-6 text-red-500"})],8,Me)])]))),128)),t("div",Se,[t("button",{onClick:l[6]||(l[6]=e=>M("richbox")),class:"btn btn-secondary"},"افزودن متن"),t("button",{onClick:l[7]||(l[7]=e=>M("image")),class:"btn btn-secondary"},"افزودن تصویر")])])]),_:1}),i(I,{title:"موجودی",class:"mt-8"},{default:y(()=>{var e;return[t("div",Te,[l[15]||(l[15]=t("div",null,"انتخاب سایز",-1)),m(t("select",{"onUpdate:modelValue":l[8]||(l[8]=n=>b.value=n),class:"select",id:""},[(u(!0),c(D,null,P(j.value,(n,o)=>(u(),c("option",{key:o,value:n},F(n),9,qe))),128))],512),[[L,b.value]])]),g.value==!0||g.value==!1&&((e=a.value)==null?void 0:e.category_id)>1?(u(!0),c(D,{key:0},P(r.value,(n,o)=>(u(),c("div",{key:o,class:"flex flex-col mt-6 lg:flex-row gap-2 justify-end"},[t("div",Ae,[i(C,{"title-class":"w-full text-right",modelValue:n.price,"onUpdate:modelValue":v=>n.price=v,class:"mt-4 font-sans","input-class":"font-sans text-center text-xl",type:"number",title:"قیمت واحد"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",Le,[i(C,{"title-class":"w-full text-right",modelValue:n.quantity,"onUpdate:modelValue":v=>n.quantity=v,class:"mt-4 font-sans","input-class":"font-sans text-center text-xl",type:"number",title:"موجودی"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",Ne,[g.value?(u(),c("button",{key:0,onClick:v=>K(n,o),class:"p-2 mb-1 border-2 border-red-500 rounded-xl cursor-pointer hover:bg-red-200 duration-200 hover:scale-105"},[i(E,{class:"size-5 text-red-700"})],8,Re)):x("",!0)])]))),128)):(u(),c("div",Ee," ابتدا دسته بندی را انتخاب کنید ")),g.value?(u(),c("div",Fe,[t("button",{onClick:H,class:"btn btn-primary"},"افزودن نوع و موجودی")])):x("",!0)]}),_:1}),i(I,{title:"تنظیمات",class:"mt-8"},{default:y(()=>{var e;return[t("div",null,[t("label",Ge,[m(t("input",{checked:a.value.published,"onUpdate:modelValue":l[9]||(l[9]=n=>a.value.published=n),type:"checkbox",class:"toggle toggle-success"},null,8,Oe),[[U,a.value.published]]),l[16]||(l[16]=V(" انتشار محصول "))])]),t("div",Je,[t("div",He,[t("button",{onClick:Q,class:"btn btn-primary px-12 btn-lg",type:"submit"},F(ne($).name=="admin_product_edit"?"ذخیره محصول":"ایجاد محصول"),1),(e=s.post)!=null&&e.title?(u(),R(p,{key:0,class:"btn btn-secondary btn-lg",target:"_blank",to:{name:"post_view",params:{id:a.value.id,title:a.value.link}}},{default:y(()=>l[17]||(l[17]=[V(" پیش نمایش ")])),_:1},8,["to"])):x("",!0)])])]}),_:1})])}}};export{tt as default};
