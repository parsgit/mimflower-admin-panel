import{_ as g}from"./MyInput-OlJ9WkVk.js";import{_ as h}from"./MyCheckbox-B7urvN-S.js";import{i as u,r as y,h as _,A as B,k,c as a,a as o,F as $,m as A,e as i,P as v,z as N,o as d,t as b}from"./index-DIhUUQa5.js";import{_ as U}from"./List-BaI1Is-_.js";const P={class:"mt-12 bg-base-200 rounded-xl shadow p-4"},j={class:"breadcrumbs text-sm p-4"},D=["onClick"],E={key:1},F={class:"bg-base-200 mt-4 p-4 rounded-b-xl w-full"},L={class:"mt-2 flex flex-wrap items-end gap-4"},M={class:"h-full flex items-center"},H={__name:"CategoryManagerView",setup(O){const c={id:0,title:"",type:"",link:""};u({...c});const l=u({...c});u([]);const r=y("0"),m=u([]),p=y([]);_(()=>{B.admin_panel_title.value="مدیریت دسته بندی ها"});const V=()=>{l.parent=r.value,v("category/save",{category:l}).then(t=>{t.ok&&(N("Success","success"),Object.assign(l,c),n())})},w=t=>{v("category/remove",{id:t.id}).then(e=>{n()})},x=(t,e)=>{e.id=="edit"?Object.assign(l,t):e.id=="open"&&(console.log(t),f(t))},n=()=>{v("category/list-by-parent",{parent:r.value}).then(t=>{t.ok&&(m.splice(0),t.list.forEach(e=>m.push(e)),p.value=t.tree)})},f=(t,e)=>{console.log(t),r.value=t.id,n()};return _(()=>{n()}),k(r,t=>{n()}),k(()=>l.title,t=>{t.length>0&&(l.link=l.title.replace(/ /g,"-").toLowerCase())}),(t,e)=>(d(),a("div",null,[e[6]||(e[6]=o("div",{class:"alert alert-info shadow-lg"}," اعمال تغییر در دسته‌بندی ها بدون دانش کافی از نحوه کار آن ممکن است باعث بروز مشکلاتی در نمایش محصولات شود ",-1)),o("div",P,[o("div",null,[o("div",j,[o("ul",null,[o("li",null,[o("a",{onClick:e[0]||(e[0]=s=>f({id:0}))},"اصلی")]),(d(!0),a($,null,A(p.value,(s,C)=>(d(),a("li",{key:s.id},[C+1<p.value.length?(d(),a("a",{key:0,onClick:S=>f(s)},b(s.title),9,D)):(d(),a("span",E,b(s.title),1))]))),128))])])]),o("div",null,[i(U,{class:"mt-4",list:m,fields:["title","link","type"],btns:[{title:"ورود",id:"open",class:"btn-info"},{title:"ویرایش",id:"edit"},{title:"حذف",id:"delete",class:"btn-error"}],"delete-action":!0,onDelete:w,onBtnAction:x},null,8,["list"])]),o("div",F,[e[5]||(e[5]=o("h3",{class:"font-bold text-xl"},"ایجاد دسته‌بندی",-1)),o("div",L,[i(g,{modelValue:l.title,"onUpdate:modelValue":e[1]||(e[1]=s=>l.title=s),title:"عنوان"},null,8,["modelValue"]),i(g,{modelValue:l.link,"onUpdate:modelValue":e[2]||(e[2]=s=>l.link=s),title:"لینک"},null,8,["modelValue"]),i(g,{modelValue:l.type,"onUpdate:modelValue":e[3]||(e[3]=s=>l.type=s),title:"نوع"},null,8,["modelValue"]),o("div",M,[i(h,{modelValue:l.main,"onUpdate:modelValue":e[4]||(e[4]=s=>l.main=s),title:"دسته‌بندی اصلی"},null,8,["modelValue"])]),o("button",{onClick:V,class:"btn btn-primary"},"ذخیره")])])])]))}};export{H as default};
