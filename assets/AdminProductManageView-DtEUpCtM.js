import{r as f,k as A,h as ee,l as te,c,e as i,f as y,P as h,G as le,u as se,g as oe,o as u,a as e,F as z,m as D,p as x,w as p,j as V,q as C,s as L,v as N,x as ae,y as R,I as E,t as F,b as ne,A as ie,z as _}from"./index-ajLuXcnK.js";import{_ as k}from"./MyInput-DL7cfE4n.js";import{_ as B}from"./Richbox-B6Gfyy1L.js";import{_ as I,I as de,a as ue}from"./IconChevronUp-1yB9vUSw.js";import{_ as G}from"./FileUploader-DiKgFPOP.js";import{_ as re}from"./CategorySelector-CaNIG6wj.js";const ce={class:"flex flex-wrap gap-4"},me={class:"flex-1 w-full"},pe={class:"grid grid-cols-1 lg:grid-cols-2 gap-2 lg:gap-8"},ve={class:"mb-4"},fe={class:"mb-4"},_e={class:"border bg-black/10 p-2 rounded-xl mt-10"},ge={dir:"rtl",class:"flex gap-4 items-center"},be={class:"flex gap-4 items-center"},ye={class:"mb-4"},he={class:"flex items-center justify-between"},xe={key:0,class:"p-4"},Ve={key:1,class:"w-full"},ke={class:"flex flex-wrap items-center gap-2 bg-gray-100 rounded-t-xl p-2 w-full"},we=["onUpdate:modelValue"],Ue=["onUpdate:modelValue"],Ce=["onUpdate:modelValue"],Ie=["onUpdate:modelValue"],$e=["onUpdate:modelValue"],je={class:"flex flex-col 2xl:flex-row items-start gap-4 justify-between w-full mt-4 p-2 lg:p-4"},Pe=["onUpdate:modelValue"],ze={class:"flex items-center gap-2 mt-4 bg-gray-100 rounded-b-xl p-2"},De=["onClick","disabled"],Be=["onClick","disabled"],Me=["onClick"],Se={class:"flex gap-4 mt-6 flex justify-center"},Te={dir:"rtl"},qe=["value"],Ae={class:"flex-1 w-full"},Le={class:"flex-1 w-full"},Ne={class:"flex-1 w-full"},Re={class:"flex justify-end items-end gap-2"},Ee=["onClick"],Fe={key:1,class:"text-xl font-bold text-center"},Ge={key:2,class:"mt-4 text-center"},Oe={for:""},Je=["checked"],He={class:"flex items-center justify-between mt-16"},Ke={class:"flex text-center w-full justify-center items-center gap-4 md:gap-8"},lt={__name:"AdminProductManageView",setup(Qe){const O=se(),$=te(),a=f({}),w=f(null),d=f([]),r=f([]),b=f(0),g=f(!0);A(()=>a.value.title,(s,l)=>{a.value.link=a.value.title.replaceAll(" ","-").toLowerCase()}),A(b,s=>{console.log("watch(selectInventory",s),r.value.length==0?r.value.push({name:s,quantity:1,type:"size",price:0}):r.value[0].name=s});const M=s=>{const l=new Date().getTime();d.value.push({id:l,type:s})},J=(s,l=!0)=>{console.log(s),h("admin/product-inventory/save",{...s,product_id:a.value.id}).then(v=>{v.ok&&l==!1&&(_("Inventory Saved","","success"),U())})},H=()=>{r.value.push({title:"",quantity:1,type:"no_type",price:0})},K=(s,l)=>{_({title:"حذف موجودی",text:`آیا از حذف  "${s.name||" اطمینان دارید "}"?`,icon:"warning",buttons:["لغو","حذف"],dangerMode:!0}).then(v=>{v&&(s.id?h("admin/product-inventory/delete",{id:s.id}).then(t=>{t.ok?(_("Deleted!","The inventory item has been removed.","success"),U()):_("Error","Failed to delete inventory item.","error")}).catch(t=>{console.error("Error deleting inventory item:",t),_("Error","An unexpected error occurred.","error")}):r.value.splice(l,1))})},Q=()=>{a.value.contents=d.value,h("admin/product/save",{...a.value}).then(s=>{if(s.ok){a.value.id=s.product.id;for(const l of r.value)J(l,!0);_({text:"محصول ذخیره شد",icon:"success"}).then(async()=>{await O.replace({name:"admin_product_edit",params:{id:s.product.id}}),U()})}else _({text:s.message,icon:"error"})})},U=()=>{const s=$.params.id;return h("admin/product/info",{id:s}).then(l=>{l.ok&&(a.value=l.product,d.value=l.product.contents,w.value.loadById(a.value.category_id),r.value=l.inventorys,P(l.category))})},S=()=>({api_token:ie.getApiToken()}),W=s=>{s>0&&([d.value[s],d.value[s-1]]=[d.value[s-1],d.value[s]])},X=s=>{s<d.value.length-1&&([d.value[s],d.value[s+1]]=[d.value[s+1],d.value[s]])},Y=s=>{d.value.splice(s,1)},Z=s=>{P(s)},j=f([]),P=(s,l=!0)=>{h("admin/setting-config/get-config-by-type",{name:"default_product_category",type:"config"}).then(v=>{var m,q;const t=le(v.config),n=JSON.parse(t.json_category.html);((m=t==null?void 0:t.disable_custom_type_creation)==null?void 0:m.value)===!0?g.value=!1:g.value=!0;const o=(q=n[s==null?void 0:s.title])==null?void 0:q.sizes;console.log("custom_sizes:",o),j.value=o,console.log("inventorys.value.length",r.value[0]),r.value.length&&(b.value=r.value[0].name,console.log("selectInventory.value",b.value)),r.value.length==0&&j.value==null&&r.value.push({name:"",quantity:1,type:"size",price:0})})},T=s=>{w.value.loadByLink(s,!1)};return ee(()=>{$.name=="admin_product_edit"?U():(P(),w.value.loadByLink("product",!1))}),(s,l)=>{const v=oe("router-link");return u(),c("div",null,[i(I,{title:"Create New Post"},{default:y(()=>[e("div",ce,[e("div",me,[e("div",pe,[e("div",ve,[i(k,{modelValue:a.value.title,"onUpdate:modelValue":l[0]||(l[0]=t=>a.value.title=t),title:"عنوان محصول","title-class":"font-bold text-base-content text-xl","input-class":"input-primary"},null,8,["modelValue"])]),e("div",fe,[i(k,{modelValue:a.value.link,"onUpdate:modelValue":l[1]||(l[1]=t=>a.value.link=t),title:"لینک محصول(اتوماتیک)","title-class":"font-bold text-base-content text-xl","input-class":"input-primary"},null,8,["modelValue"])])]),e("div",_e,[e("div",ge,[l[10]||(l[10]=e("div",null,[e("h3",{dir:"auto",class:"text-xl font-bold"},"انتخاب دسته بندی")],-1)),e("div",be,[e("button",{onClick:l[2]||(l[2]=t=>T("product")),class:"btn btn-primary btn-sm"},"محصولات"),e("button",{onClick:l[3]||(l[3]=t=>T("some-product")),class:"btn btn-primary btn-sm"},"محصولات جانبی")])]),i(re,{class:"mt-8","show-tree":!1,onSelect:Z,ref_key:"categoryComponent",ref:w,"btn-default":!1,"select-mode":!1,"btn-open":!1,"btn-select":!0,modelValue:a.value.category_id,"onUpdate:modelValue":l[4]||(l[4]=t=>a.value.category_id=t)},null,8,["modelValue"])])]),e("div",null,[i(G,{"upload-url":"admin/upload-image/product","upload-params":S(),title:"عکس شاخص محصول",class:"w-72",modelValue:a.value.image,"onUpdate:modelValue":l[5]||(l[5]=t=>a.value.image=t)},null,8,["upload-params","modelValue"])])])]),_:1}),i(I,{title:"Content",class:"mt-8"},{default:y(()=>[e("div",ye,[(u(!0),c(z,null,D(d.value,(t,n)=>(u(),c("div",{key:t.id,class:"mb-4 bg-white shadow-md rounded-xl"},[e("div",he,[t.type=="richbox"?(u(),c("div",xe,[i(B,{title:"متن","com-id":t.id,modelValue:t.content,"onUpdate:modelValue":o=>t.content=o},null,8,["com-id","modelValue","onUpdate:modelValue"])])):t.type=="image"?(u(),c("div",Ve,[e("div",ke,[e("div",null,[p(e("input",{type:"checkbox","onUpdate:modelValue":o=>t.active_left_content=o,class:"toggle toggle-success"},null,8,we),[[C,t.active_left_content]]),l[11]||(l[11]=V(" Left Description "))]),e("div",null,[p(e("input",{type:"checkbox","onUpdate:modelValue":o=>t.active_right_content=o,class:"toggle toggle-success"},null,8,Ue),[[C,t.active_right_content]]),l[12]||(l[12]=V(" Right Description "))]),e("div",null,[p(e("input",{type:"checkbox","onUpdate:modelValue":o=>t.items_center=o,class:"toggle toggle-success"},null,8,Ce),[[C,t.items_center]]),l[13]||(l[13]=V(" Items Center "))]),e("div",null,[p(e("select",{"onUpdate:modelValue":o=>t.align=o,class:"select select-bordered"},l[14]||(l[14]=[e("option",{disabled:""},"Select align",-1),e("option",{value:"left"},"Left",-1),e("option",{value:"center"},"Center",-1),e("option",{value:"right"},"Right",-1)]),8,Ie),[[L,t.align]])]),e("div",null,[p(e("input",{"onUpdate:modelValue":o=>t.max_width=o,placeholder:"max width",type:"text",class:"input"},null,8,$e),[[N,t.max_width]])])]),e("div",je,[e("div",null,[p(i(B,{"com-id":"el"+t.id,modelValue:t.left_content,"onUpdate:modelValue":o=>t.left_content=o,title:""},null,8,["com-id","modelValue","onUpdate:modelValue"]),[[ae,t.active_left_content]])]),e("div",null,[p(e("input",{class:"input input-primary",placeholder:"Image alt","onUpdate:modelValue":o=>t.alt=o,type:"text"},null,8,Pe),[[N,t.alt]]),i(G,{id:"file_uploader"+n,"upload-url":"admin/upload-image/product","upload-params":S(),title:"Upload photo",class:"w-72 mt-2 min-w-[300px]",modelValue:t.image,"onUpdate:modelValue":o=>t.image=o,"max-w":"400"},null,8,["id","upload-params","modelValue","onUpdate:modelValue"])]),e("div",null,[t.active_right_content?(u(),R(B,{key:0,"com-id":"er"+t.id,modelValue:t.right_content,"onUpdate:modelValue":o=>t.right_content=o,title:"Right Description"},null,8,["com-id","modelValue","onUpdate:modelValue"])):x("",!0)])])])):x("",!0)]),e("div",ze,[e("button",{onClick:o=>W(n),disabled:n===0,class:"btn btn-secondary btn-sm"},[i(de,{class:"size-8"})],8,De),e("button",{onClick:o=>X(n),disabled:n===d.value.length-1,class:"btn btn-secondary btn-sm"},[i(ue,{class:"size-8"})],8,Be),e("button",{onClick:o=>Y(n),class:"btn btn-danger btn-sm"},[i(E,{class:"size-6 text-red-500"})],8,Me)])]))),128)),e("div",Se,[e("button",{onClick:l[6]||(l[6]=t=>M("richbox")),class:"btn btn-secondary"},"افزودن متن"),e("button",{onClick:l[7]||(l[7]=t=>M("image")),class:"btn btn-secondary"},"افزودن تصویر")])])]),_:1}),i(I,{title:"موجودی",class:"mt-8"},{default:y(()=>{var t;return[e("div",Te,[l[15]||(l[15]=e("div",null,"انتخاب سایز",-1)),p(e("select",{"onUpdate:modelValue":l[8]||(l[8]=n=>b.value=n),class:"select",id:""},[(u(!0),c(z,null,D(j.value,(n,o)=>(u(),c("option",{key:o,value:n},F(n),9,qe))),128))],512),[[L,b.value]])]),g.value==!0||g.value==!1&&((t=a.value)==null?void 0:t.category_id)>1?(u(!0),c(z,{key:0},D(r.value,(n,o)=>(u(),c("div",{key:o,class:"flex flex-col mt-6 lg:flex-row gap-2 justify-end"},[e("div",Ae,[i(k,{"title-class":"w-full text-right",modelValue:n.discountPrice,"onUpdate:modelValue":m=>n.discountPrice=m,class:"mt-4 font-sans","input-class":"font-sans text-center text-xl",type:"number",title:"قیمت همراه تخفیف"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",Le,[i(k,{"title-class":"w-full text-right",modelValue:n.price,"onUpdate:modelValue":m=>n.price=m,class:"mt-4 font-sans","input-class":"font-sans text-center text-xl",type:"number",title:"قیمت واحد (قیمت اصلی)"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",Ne,[i(k,{"title-class":"w-full text-right",modelValue:n.quantity,"onUpdate:modelValue":m=>n.quantity=m,class:"mt-4 font-sans","input-class":"font-sans text-center text-xl",type:"number",title:"موجودی"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",Re,[g.value?(u(),c("button",{key:0,onClick:m=>K(n,o),class:"p-2 mb-1 border-2 border-red-500 rounded-xl cursor-pointer hover:bg-red-200 duration-200 hover:scale-105"},[i(E,{class:"size-5 text-red-700"})],8,Ee)):x("",!0)])]))),128)):(u(),c("div",Fe," ابتدا دسته بندی را انتخاب کنید ")),g.value?(u(),c("div",Ge,[e("button",{onClick:H,class:"btn btn-primary"},"افزودن نوع و موجودی")])):x("",!0)]}),_:1}),i(I,{title:"تنظیمات",class:"mt-8"},{default:y(()=>{var t;return[e("div",null,[e("label",Oe,[p(e("input",{checked:a.value.published,"onUpdate:modelValue":l[9]||(l[9]=n=>a.value.published=n),type:"checkbox",class:"toggle toggle-success"},null,8,Je),[[C,a.value.published]]),l[16]||(l[16]=V(" انتشار محصول "))])]),e("div",He,[e("div",Ke,[e("button",{onClick:Q,class:"btn btn-primary px-12 btn-lg",type:"submit"},F(ne($).name=="admin_product_edit"?"ذخیره محصول":"ایجاد محصول"),1),(t=s.post)!=null&&t.title?(u(),R(v,{key:0,class:"btn btn-secondary btn-lg",target:"_blank",to:{name:"post_view",params:{id:a.value.id,title:a.value.link}}},{default:y(()=>l[17]||(l[17]=[V(" پیش نمایش ")])),_:1},8,["to"])):x("",!0)])])]}),_:1})])}}};export{lt as default};
